<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Ficha de Inscri√ß√£o - Encontro JOSUE</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body { font-family: sans-serif; background: #f0f0f0; margin: 20px; }
    form { background: #fff; padding: 20px; border-radius: 8px; max-width: 700px; margin: auto; }
    label { display: block; margin-top: 10px; font-weight: bold; }
    input, textarea { width: 100%; padding: 8px; margin-top: 5px; border-radius: 4px; border: 1px solid #ccc; }
    .radio-group { display: flex; gap: 20px; margin-top: 5px; }
    button { margin-top: 20px; padding: 10px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; }
    button:hover { background: #218838; }
  </style>
</head>
<body>
  <h1 style="text-align:center;">Ficha de Inscri√ß√£o - Encontro JOSUE</h1>
  <form id="formInscricao">
    <label>Nome:</label>
    <input type="text" name="nome" required>

    <label>Endere√ßo:</label>
    <input type="text" name="endereco" required>

    <label>Cidade:</label>
    <input type="text" name="cidade" required>

    <label>Data de Nascimento:</label>
    <input type="date" name="nascimento" required>

    <label>Estado Civil:</label>
    <div class="radio-group">
      <label><input type="radio" name="estadoCivil" value="Solteiro(a)" required> Solteiro(a)</label>
      <label><input type="radio" name="estadoCivil" value="Casado(a)"> Casado(a)</label>
    </div>

    <label>Telefone:</label>
    <input type="tel" name="telefone" required>

    <label>Celular:</label>
    <input type="tel" name="celular" required>

    <label>Contato 1:</label>
    <input type="text" name="contato1" required>

    <label>Contato 2:</label>
    <input type="text" name="contato2" required>

    <label>Faz parte de igreja evang√©lica?</label>
    <div class="radio-group">
      <label><input type="radio" name="igrejaEvangelica" value="Sim" required> Sim</label>
      <label><input type="radio" name="igrejaEvangelica" value="N√£o"> N√£o</label>
    </div>

    <label>Qual igreja?</label>
    <input type="text" name="nomeIgreja" required>

    <label>J√° fez o Encontro com Deus?</label>
    <div class="radio-group">
      <label><input type="radio" name="encontroComDeus" value="Sim" required> Sim</label>
      <label><input type="radio" name="encontroComDeus" value="N√£o"> N√£o</label>
    </div>

    <label>Faz uso de medicamento controlado?</label>
    <div class="radio-group">
      <label><input type="radio" name="medicamentoControlado" value="Sim" required> Sim</label>
      <label><input type="radio" name="medicamentoControlado" value="N√£o"> N√£o</label>
    </div>

    <label>Hor√°rios da medica√ß√£o:</label>
    <textarea name="horariosMedicacao" rows="3" required></textarea>

    <button type="submit">Enviar Inscri√ß√£o</button>
  </form>

  <script>
    // üîó URL do Google Apps Script
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw8cxBIVqAa9vSJ707x2kk2ZJBa_6bF6H9tjsEI5iY0Esgq7TekKw17y8PyaCOwP7pk7g/exec";

    document.getElementById('formInscricao').addEventListener('submit', async function(e) {
      e.preventDefault();
      const formData = new FormData(e.target);
      const data = {};
      formData.forEach((value, key) => data[key] = value);

      try {
        const resp = await fetch(SCRIPT_URL, {
          method: 'POST',
          body: JSON.stringify(data)
        });
        const result = await resp.json();

        if (result.success) {
          const numero = result.numero;

          // === PDF Estilizado com LOGO ===
          const { jsPDF } = window.jspdf;
          const doc = new jsPDF();

          // üîó Substitua por sua logo hospedada em link p√∫blico (PNG ou JPG)
          const logoUrl = "https://ibb.co/YFGSSCQp"; 
          const img = new Image();
          img.src = logoUrl;
          await new Promise(resolve => { img.onload = resolve; });

          // Insere logo no topo (ajuste x, y, largura, altura conforme sua imagem)
          doc.addImage(img, "PNG", 85, 5, 40, 15);

          // Cabe√ßalho
          doc.setFont("helvetica", "bold");
          doc.setFontSize(16);
          doc.text("Ficha de Inscri√ß√£o - Encontro JOSUE", 105, 25, { align: "center" });
          doc.line(20, 30, 190, 30);

          // N√∫mero da inscri√ß√£o em destaque
          doc.setFontSize(12);
          doc.setFont("helvetica", "bold");
          doc.setDrawColor(0);
          doc.setFillColor(230, 230, 230);
          doc.rect(70, 35, 70, 10, "F");
          doc.rect(70, 35, 70, 10);
          doc.text(`Inscri√ß√£o N¬∫: ${numero}`, 105, 42, { align: "center" });

          let y = 55;

          // Dados formatados
          doc.setFontSize(11);
          doc.setFont("helvetica", "normal");
          for (const [key, value] of Object.entries(data)) {
            doc.setFont("helvetica", "bold");
            doc.text(`${key}:`, 20, y);
            doc.setFont("helvetica", "normal");
            doc.text(String(value), 70, y);
            y += 8;
            if (y > 270) {
              doc.addPage();
              y = 20;
            }
          }

          // Linha de assinatura
          if (y < 250) {
            y += 20;
          }
          doc.line(60, y, 150, y);
          doc.text("Assinatura", 105, y + 6, { align: "center" });

          // Rodap√©
          const dataAtual = new Date().toLocaleString("pt-BR");
          doc.setFontSize(9);
          doc.text(`Emitido em: ${dataAtual}`, 105, 290, { align: "center" });

          // Salvar PDF
          doc.save(`Ficha_Inscricao_${numero}.pdf`);
          // ========================

          e.target.reset();
          alert(`Inscri√ß√£o enviada com sucesso! Seu n√∫mero √© ${numero}. O PDF foi baixado.`);
        } else {
          alert('Erro ao enviar inscri√ß√£o: ' + result.error);
        }
      } catch (err) {
        alert('Falha na conex√£o com o servidor.');
      }
    });
  </script>
</body>
</html>

